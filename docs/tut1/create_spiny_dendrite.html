<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'G-C62LL715FS']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>3.1. Create a shape &mdash; lattice dendrites 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.2. Label a spine" href="label_spine.html" />
    <link rel="prev" title="3. Tutorial 1: schematic dendrite" href="../03.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> lattice dendrites
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.html">2. Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../03.html">3. Tutorial 1: schematic dendrite</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.1. Create a shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="label_spine.html">3.2. Label a spine</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_model.html">3.3. Build models</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_simulation.html">3.4. Run simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization1_graph_plot.html">3.5. Visualization 1: graph plot</a></li>
<li class="toctree-l2"><a class="reference internal" href="visualization2_video.html">3.6. Visualization 2: video</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../04.html">4. Tutorial 2: realistic dendrite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.html">5. Copyright</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">lattice dendrites</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../03.html"><span class="section-number">3. </span>Tutorial 1: schematic dendrite</a> &raquo;</li>
      <li><span class="section-number">3.1. </span>Create a shape</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tut1/create_spiny_dendrite.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="create-a-shape">
<h1><span class="section-number">3.1. </span>Create a shape<a class="headerlink" href="#create-a-shape" title="Permalink to this headline"></a></h1>
<ol class="arabic simple">
<li><p>We first draw a blueprint to make a spiny dendrite as a combination of geometric shapes (Figure below). A sphere (radius: 0.25 μm) represents a spine head, which is partially labeled as a postsynaptic density (PSD; red colored area). The spine head has a cylindrical spike neck (radius: 0.1 μm, length 1.0 μm), and it is further connected to a parent dendrite that also has a cylindrical shape (radius: 0.5 μm, length 1.8 μm). Not only the contour of spiny dendrite, we also introduce two types of intracellular organelles. Endoplasmic reticulum (ER) is set as thin cylinders (radius: 0.08 μm, length 1.8 μm; green colored objects), and a mitochondrion is set as a thich cylinder (radius: 0.2 μm, length 1.8 μm; yellow colored objects).</p></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference internal image-reference" href="../_images/Scheme.jpg"><img alt="../_images/Scheme.jpg" class="align-center" src="../_images/Scheme.jpg" style="width: 676.1999999999999px; height: 507.0px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="2">
<li><p>The designed shape is embedded in a voxel space for simulation (Lines 1-35, 11_create_dend.py). First, a voxel space of 96 × 60 × 96 voxels (20 nm/voxel) is set as a numpy 3D array ‘vol_dend’ (Line 14). Then, the spine head is created using a Python module function morphology.ball (skimage; Line 10; 0.25 μm, 12 voxels), which is added to ‘vol_dend’ (add_shape; Line 15). Similarly, we make the spine neck and dendrite as cylinders (Lines 11 and 12, respectively), and add them to ‘vol_dend’ (Lines 16 and 17, respectively). The in-house function ‘add_shape,’ simply overlays overwrapped regions, and represents the filled areas as 1 (cytosolic region) and the void areas as 0 (extracellular region). Thus, we have already built the contour of the spiny dendrite in ‘vol_dend.’ Similarly, the PSD, Mitochondrion, and ER are embedded in vol_psd, vol_mito, and vol_er, respectively.</p></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="3">
<li><p>Here, the volume sizes need to be corrected. LM can only simulate the volume with a size of a multiple of 32 × 32 × 32 voxels, whereas the current voxel size is 96 × 60 × 96 voxels. We thus execute a utility function ‘lmpad’ (Lines 39-42). The voxel sizes are automatically expanded to the multiple of 32 (96 × 64 × 96 voxels in this case). Users can of course set a multiple of 32 voxels from the beginning.</p></li>
</ol>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">11_create_dend.py</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="linenos"> 4</span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">morphology</span>
<span class="linenos"> 5</span><span class="kn">from</span> <span class="nn">pyLD</span> <span class="kn">import</span> <span class="o">*</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">tut1_functions</span> <span class="kn">import</span> <span class="n">make_cylinder</span><span class="p">,</span> <span class="n">add_shape</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1"># Spiny dendrite</span>
<span class="linenos">10</span><span class="n">spine_head</span> <span class="o">=</span> <span class="n">morphology</span><span class="o">.</span><span class="n">ball</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>
<span class="linenos">11</span><span class="n">spine_neck</span> <span class="o">=</span> <span class="n">make_cylinder</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos">12</span><span class="n">dendrite</span> <span class="o">=</span> <span class="n">make_cylinder</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">25</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="n">vol_dend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">96</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">96</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="linenos">15</span><span class="n">vol_dend</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">,</span> <span class="n">spine_head</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">76</span><span class="p">])</span>
<span class="linenos">16</span><span class="n">vol_dend</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">,</span> <span class="n">spine_neck</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">51</span><span class="p">])</span>
<span class="linenos">17</span><span class="n">vol_dend</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">,</span> <span class="n">dendrite</span>  <span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">26</span><span class="p">])</span>
<span class="linenos">18</span>
<span class="linenos">19</span>
<span class="linenos">20</span><span class="c1"># PSD</span>
<span class="linenos">21</span><span class="n">psd</span> <span class="o">=</span> <span class="n">morphology</span><span class="o">.</span><span class="n">ball</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>
<span class="linenos">22</span><span class="n">vol_psd</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">),</span> <span class="n">psd</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">88</span><span class="p">])</span>
<span class="linenos">23</span>
<span class="linenos">24</span>
<span class="linenos">25</span><span class="c1"># Mito</span>
<span class="linenos">26</span><span class="n">mito</span> <span class="o">=</span> <span class="n">make_cylinder</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">27</span><span class="n">vol_mito</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">)</span>
<span class="linenos">28</span><span class="n">vol_mito</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_mito</span><span class="p">,</span> <span class="n">mito</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">26</span><span class="p">])</span>
<span class="linenos">29</span>
<span class="linenos">30</span>
<span class="linenos">31</span><span class="c1"># ER</span>
<span class="linenos">32</span><span class="n">er</span> <span class="o">=</span> <span class="n">make_cylinder</span><span class="p">(</span><span class="n">radius</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="mi">90</span><span class="p">,</span> <span class="n">direction</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
<span class="linenos">33</span><span class="n">vol_er</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">)</span>
<span class="linenos">34</span><span class="n">vol_er</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_er</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span>
<span class="linenos">35</span><span class="n">vol_er</span> <span class="o">=</span> <span class="n">add_shape</span><span class="p">(</span><span class="n">vol_er</span><span class="p">,</span> <span class="n">er</span><span class="p">,</span> <span class="p">[</span><span class="mi">48</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">45</span><span class="p">])</span>
<span class="linenos">36</span>
<span class="linenos">37</span>
<span class="linenos">38</span><span class="c1"># Arrangement</span>
<span class="linenos">39</span><span class="n">vol_dend</span> <span class="o">=</span> <span class="n">lmpad</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">)</span>
<span class="linenos">40</span><span class="n">vol_mito</span> <span class="o">=</span> <span class="n">lmpad</span><span class="p">(</span><span class="n">vol_mito</span><span class="p">)</span>
<span class="linenos">41</span><span class="n">vol_psd</span>  <span class="o">=</span> <span class="n">lmpad</span><span class="p">(</span><span class="n">vol_psd</span><span class="p">)</span>
<span class="linenos">42</span><span class="n">vol_er</span>   <span class="o">=</span> <span class="n">lmpad</span><span class="p">(</span><span class="n">vol_er</span><span class="p">)</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="n">vol_not_er</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span> <span class="n">vol_er</span> <span class="p">)</span>
<span class="linenos">45</span><span class="n">vol_not_mito</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_not</span><span class="p">(</span> <span class="n">vol_mito</span> <span class="p">)</span>
<span class="linenos">46</span><span class="n">vol_dend_not_mito_not_er</span> <span class="o">=</span> <span class="n">vol_dend</span> <span class="o">^</span> <span class="p">(</span><span class="n">vol_mito</span> <span class="o">|</span> <span class="n">vol_er</span><span class="p">)</span>
<span class="linenos">47</span>
<span class="linenos">48</span>
<span class="linenos">49</span><span class="c1"># Create surface</span>
<span class="linenos">50</span><span class="n">xyzpitch</span> <span class="o">=</span> <span class="mf">0.02</span>
<span class="linenos">51</span><span class="n">m</span> <span class="o">=</span> <span class="p">{}</span>
<span class="linenos">52</span>
<span class="linenos">53</span><span class="n">dend</span> <span class="o">=</span> <span class="n">CreateSurface</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">,</span> <span class="n">xyzpitch</span><span class="p">,</span> <span class="n">num_smoothing</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">method_smoothing</span> <span class="o">=</span> <span class="s1">&#39;laplacian&#39;</span><span class="p">)</span>
<span class="linenos">54</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;bound vertices&#39;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">dend</span><span class="o">.</span><span class="n">vertices</span>
<span class="linenos">55</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;bound faces&#39;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">dend</span><span class="o">.</span><span class="n">faces</span>
<span class="linenos">56</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;bound faces in volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dend</span><span class="o">.</span><span class="n">get_surface_to_volume</span><span class="p">()</span>
<span class="linenos">57</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;bound faces in volume&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">vol_dend_not_mito_not_er</span>
<span class="linenos">58</span><span class="n">face_id_psd</span> <span class="o">=</span> <span class="n">dend</span><span class="o">.</span><span class="n">get_face_ids_inside</span><span class="p">(</span><span class="n">vol_psd</span><span class="p">)</span>
<span class="linenos">59</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;psd faces in volume&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">dend</span><span class="o">.</span><span class="n">get_surface_to_volume</span><span class="p">(</span><span class="n">face_id_psd</span><span class="p">)</span>
<span class="linenos">60</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;psd faces in volume&#39;</span><span class="p">]</span>   <span class="o">*=</span> <span class="n">vol_dend_not_mito_not_er</span>
<span class="linenos">61</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;face id psd&#39;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">face_id_psd</span>
<span class="linenos">62</span>
<span class="linenos">63</span><span class="n">mito</span> <span class="o">=</span> <span class="n">CreateSurface</span><span class="p">(</span><span class="n">vol_not_mito</span><span class="p">,</span> <span class="n">xyzpitch</span><span class="p">)</span>
<span class="linenos">64</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;mito vertices&#39;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">mito</span><span class="o">.</span><span class="n">vertices</span>
<span class="linenos">65</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;mito faces&#39;</span><span class="p">]</span>            <span class="o">=</span> <span class="n">mito</span><span class="o">.</span><span class="n">faces</span>
<span class="linenos">66</span>
<span class="linenos">67</span><span class="n">er</span> <span class="o">=</span> <span class="n">CreateSurface</span><span class="p">(</span><span class="n">vol_not_er</span><span class="p">,</span> <span class="n">xyzpitch</span><span class="p">)</span>
<span class="linenos">68</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;er vertices&#39;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">er</span><span class="o">.</span><span class="n">vertices</span>
<span class="linenos">69</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;er faces&#39;</span><span class="p">]</span>              <span class="o">=</span> <span class="n">er</span><span class="o">.</span><span class="n">faces</span>
<span class="linenos">70</span>
<span class="linenos">71</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;unit length (um)&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">xyzpitch</span>
<span class="linenos">72</span>
<span class="linenos">73</span><span class="n">tot_volume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">vol_dend</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;uint8&#39;</span><span class="p">)</span>
<span class="linenos">74</span><span class="n">tot_volume</span><span class="p">[</span><span class="n">vol_dend</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">75</span><span class="n">tot_volume</span><span class="p">[</span><span class="n">vol_mito</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>   <span class="o">=</span> <span class="mi">2</span>
<span class="linenos">76</span><span class="n">tot_volume</span><span class="p">[</span><span class="n">vol_er</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>     <span class="o">=</span> <span class="mi">3</span>
<span class="linenos">77</span><span class="n">m</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tot_volume</span>
<span class="linenos">78</span>
<span class="linenos">79</span><span class="c1"># Save</span>
<span class="linenos">80</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;models/ball_and_stick.h5&#39;</span>
<span class="linenos">81</span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">82</span>
<span class="linenos">83</span><span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">w</span><span class="p">:</span>
<span class="linenos">84</span>	<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">m</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="linenos">85</span>		<span class="n">w</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="4">
<li><p>Then, we use the CreateSurface class to generate smoothed surfaces of each object (Lines 53, 63, and 67). The generated surfaces are required for locating surface molecules as well as visualizing simulation results. Each surface is composed of triangles that are specified by three vertices (Lines 55 and 56, respectively). Also, the CreateSurface class can generate the surface areas per volume. LD can distribute surface molecules in the voxel space, depending on the surface areas per volume (Line 56). We can further select the surface triangles within the areas of PSD (face_id_psd, Lines 58, 59), to distribute molecules only in this area.</p></li>
</ol>
<div class="line-block">
<div class="line"><br /></div>
</div>
<ol class="arabic simple" start="5">
<li><p>Finally, the generated variables are assembled in a Python dictionary variable ‘m’ (Lines 51-77), and ‘m’ is saved into the HDF container file ‘models/ball_and_stick.h5’ (Lines 79-85).</p></li>
</ol>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">12_show_dend.py</span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">os</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">tut1_functions</span> <span class="kn">import</span> <span class="n">show_dendrite</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">input_morpho_file</span> <span class="o">=</span> <span class="s2">&quot;models/ball_and_stick.h5&quot;</span>
<span class="linenos"> 5</span><span class="n">output_image_file</span> <span class="o">=</span> <span class="s2">&quot;imgs/ball_and_stick.png&quot;</span>
<span class="linenos"> 6</span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;imgs&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="n">mlab</span> <span class="o">=</span> <span class="n">show_dendrite</span><span class="p">(</span><span class="n">input_morpho_file</span><span class="p">)</span>
<span class="linenos"> 9</span><span class="n">mlab</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">output_image_file</span><span class="p">)</span>
<span class="linenos">10</span><span class="n">mlab</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<a class="reference internal image-reference" href="../_images/ball_and_stick.png"><img alt="../_images/ball_and_stick.png" class="align-center" src="../_images/ball_and_stick.png" style="width: 350.0px; height: 326.0px;" /></a>
<ol class="arabic simple" start="6">
<li><p>Execute ‘python3 11_create_dend.py’. If users have successfully created the volumes and surfaces, the subsequent script ‘python3 12_show_dend.py’ will show its 3D shape (Figure above). We use the spiny dendrite for simulation.</p></li>
</ol>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../03.html" class="btn btn-neutral float-left" title="3. Tutorial 1: schematic dendrite" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="label_spine.html" class="btn btn-neutral float-right" title="3.2. Label a spine" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Hidetoshi Urakubo.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>